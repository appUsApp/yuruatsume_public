import Foundation

struct MonsterData {
    static let beach: [String] = [
        "8", "9", "10", "12", "15", "16", "17", "21", "22", "23",
        "25", "26", "28", "33", "34", "37", "38", "39", "40", "48",
        "49", "50", "53", "58", "59", "69", "70", "71", "72", "84",
        "85", "nulldrago"
    ]

    static let fish: [String] = [
        "2", "13", "14", "19", "32", "35", "36", "41", "44", "45",
        "47", "52", "54", "55", "56", "75", "76", "78", "79",
        "negaiumiushi"
    ]

    static let ford: [String] = [
        "1", "3", "4", "5", "6", "7", "11", "18", "27", "29",
        "30", "31", "42", "57", "63", "73", "74", "77", "80",
        "86", "hyoutankurage"
    ]

    static let sand: [String] = [
        "20", "24", "43", "46", "51", "60", "61", "62", "64", "65",
        "66", "67", "68", "81", "82", "83", "suncharger"
    ]

    static let shopMapMonsters: [String: [String]] = [
        "うずしおオルガン": (91...100).map { "\($0)" },
        "くらげのそらまど": (101...110).map { "\($0)" },
        "さざめき浜": (111...120).map { "\($0)" },
        "ねむれる書の根": (121...130).map { "\($0)" },
        "ひかる石段": (131...140).map { "\($0)" },
        "ふたつ陽の海辺": (141...150).map { "\($0)" },
        "海の鳥居": (151...160).map { "\($0)" },
        "貝火のどうくつ": (161...170).map { "\($0)" },
        "星灯の読み処": (171...180).map { "\($0)" },
        "蒼環のらせん": (181...190).map { "\($0)" },
        "潮映回廊": (191...200).map { "\($0)" },
        "潮渡りの門": (201...210).map { "\($0)" },
        "波書のうまれる浜": (211...220).map { "\($0)" },
        "泡天のはて": (221...230).map { "\($0)" },
        "満月のテラス": (231...240).map { "\($0)" },
        "満月の船橋": (241...250).map { "\($0)" },
        "夕映の貝望台": (251...260).map { "\($0)" },
    ]

    static let shop: [String] = shopMapMonsters.values.flatMap { $0 }

    static var all: [String] { beach + fish + ford + sand + shop }

    private static let beachIDs: Set<Int> = {
        Set((beach + sand).map { id(for: $0) }.filter { $0 > 0 })
    }()

    private static let fishIDs: Set<Int> = {
        Set((fish + ford).map { id(for: $0) }.filter { $0 > 0 })
    }()

    private static let shopLocationLookup: [Int: String] = {
        var map: [Int: String] = [:]
        for (location, names) in shopMapMonsters {
            for name in names {
                let monsterId = id(for: name)
                if monsterId > 0 {
                    map[monsterId] = location
                }
            }
        }
        return map
    }()

    static func monsterIds(for location: String) -> [String] {
        shopMapMonsters[location] ?? beach + sand
    }

    static func appearLocations(for monsterId: Int) -> [String] {
        var results: [String] = []
        func appendUnique(_ value: String) {
            if !results.contains(value) {
                results.append(value)
            }
        }

        if beachIDs.contains(monsterId) {
            appendUnique("BeachScratch")
        }

        if fishIDs.contains(monsterId) {
            appendUnique("FishAppear")
        }

        if let location = shopLocationLookup[monsterId] {
            appendUnique(location)
        }

        return results
    }

    private static let info: [Int: Int] = [
        1: 1, 2: 2, 3: 5, 4: 3, 5: 5,
        6: 3, 7: 1, 8: 4, 9: 3, 10: 3,
        11: 4, 12: 3, 13: 5, 14: 5, 15: 5,
        16: 4, 17: 3, 18: 3, 19: 4, 20: 5,
        21: 2, 22: 3, 23: 2, 24: 5, 25: 3,
        26: 4, 27: 4, 28: 3, 29: 5, 30: 3,
        31: 3, 32: 2, 33: 2, 34: 3, 35: 4,
        36: 2, 37: 3, 38: 2, 39: 1, 40: 2,
        41: 1, 42: 3, 43: 2, 44: 3, 45: 2,
        46: 2, 47: 5, 48: 1, 49: 4, 50: 3,
        51: 1, 52: 2, 53: 4, 54: 2, 55: 5,
        56: 1, 57: 5, 58: 4, 59: 2, 60: 4,
        61: 3, 62: 3, 63: 4, 64: 2, 65: 3,
        66: 4, 67: 2, 68: 3, 69: 1, 70: 3,
        71: 4, 72: 3, 73: 3, 74: 2, 75: 1,
        76: 1, 77: 4, 78: 1, 79: 5, 80: 2,
        81: 4, 82: 3, 83: 5, 84: 1, 85: 1,
        86: 1, 87: 4, 88: 4, 89: 3, 90: 5,
        91: 4, // プクドラ
        92: 4, // アモネコ
        93: 2, // ソナフィン
        94: 3, // ツキバブル
        95: 2, // ネジフィン
        96: 3, // フカシドリ
        97: 5, // ケムリザ
        98: 3, // サンコロ
        99: 4, // スナグマ
        100: 3, // ステップ
        101: 3, // ウィングラゲ
        102: 5, // ルナジェリー
        103: 3, // ネムクラゲ
        104: 4, // ツキクジラ
        105: 4, // ホシジカ
        106: 3, // ディープクラゲ
        107: 5, // ナガレヒツジ
        108: 4, // アクアホース
        109: 2, // スタークラゲ
        110: 1, // クージェル
        111: 5, // ギャラクダ
        112: 4, // ホシゴマ
        113: 4, // ホシギツネ
        114: 2, // フレアオクト
        115: 3, // ナギガメ
        116: 3, // フレアフライ
        117: 3, // ツキジカ
        118: 5, // サクラドリ
        119: 1, // シェルスズメ
        120: 4, // オトフクモチ
        121: 3, // ヤミラン
        122: 3, // ホムニコ
        123: 3, // ウタドリ
        124: 2, // ミラリー
        125: 5, // ナイトフェア
        126: 2, // ライブラクモ
        127: 3, // モクレイス
        128: 4, // ロックニャン
        129: 3, // リーフリス
        130: 4, // モノガミネコ
        131: 2, // ヒカリカブト
        132: 4, // ヨルフラワ
        133: 3, // サンドニャ
        134: 4, // リーフスタグ
        135: 5, // フワニャ
        136: 4, // スカーフレット
        137: 4, // フクプー
        138: 3, // スナモチ
        139: 4, // ノビニャン
        140: 4, // ヒナモリス
        141: 4, // ギアタートル
        142: 4, // シーホルダー
        143: 4, // サギパイル
        144: 3, // ウイングラット
        145: 2, // オクタウェーブ
        146: 2, // スナフクロウ
        147: 4, // ミズダマリン
        148: 3, // フワシール
        149: 3, // アクアワン
        150: 4, // コモリスズメ
        151: 2, // ルミファーン
        152: 3, // アクアフレア
        153: 2, // バブルテール
        154: 3, // ドロップシェード
        155: 5, // アワコン
        156: 4, // プククロ
        157: 3, // スプラビット
        158: 3, // ルナキャット
        159: 3, // スリーピック
        160: 4, // アワネコ
        161: 2, // フレアシップ
        162: 3, // ロックマイナー
        163: 2, // ルビージェリー
        164: 4, // コラルホース
        165: 4, // フレイムハウンド
        166: 3, // モスザード
        167: 2, // ホシネコ
        168: 3, // アップルモチ
        169: 4, // カフェモチ
        170: 3, // ヘルヘム
        171: 4, // インクスモーク
        172: 3, // ハリドア
        173: 5, // ヨムコアラ
        174: 5, // クロフワ
        175: 2, // モカフクロウ
        176: 1, // スペルブックル
        177: 3, // ルナリンクス
        178: 4, // トワミミズク
        179: 3, // ヨルスラグ
        180: 4, // フミリス
        181: 3, // フラッシュフィン
        182: 3, // アクアフラッタ
        183: 3, // ゴールドモス
        184: 3, // バブルホース
        185: 3, // ジェットフィッシュ
        186: 4, // ラグーンパピー
        187: 5, // ブロンズインプ
        188: 3, // コロポン
        189: 3, // トゲヨーヨー
        190: 4, // ユメクイバク
        191: 2, // にゃー
        192: 2, // みゃー
        193: 2, // んにゃー
        194: 2, // うにゃ
        195: 2, // ナイトクロウ
        196: 2, // スパイスタグ
        197: 3, // ボトリート
        198: 3, // ネムキャット
        199: 2, // クリームリス
        200: 2, // テノリラット
        201: 2, // コーラルラビ
        202: 2, // ブルーバブ
        203: 3, // ブラスダイバー
        204: 3, // プラティッシュ
        205: 3, // スナスプラウト
        206: 3, // ルイナイト
        207: 4, // ウォールクロウ
        208: 2, // リングザウル
        209: 4, // クモヒツジ
        210: 4, // ネムリオモシ
        211: 2, // スタークトパス
        212: 3, // スミプチ
        213: 3, // ルミノグリフ
        214: 3, // ウェーブゴーレ
        215: 4, // トレードキャメル
        216: 3, // ネムカメ
        217: 4, // アイスベアフロート
        218: 3, // フロッグガイド
        219: 2, // ハナクマ
        220: 3, // ユラユラカゲ
        221: 3, // スピラホース
        222: 3, // シュワワーム
        223: 3, // ニジビースト
        224: 4, // レインドラ
        225: 5, // モコリ
        226: 4, // もちうさ
        227: 4, // ワタミミ
        228: 4, // フチョン
        229: 4, // ユメノモコモコ
        230: 4, // モココロネ
        231: 3, // スプラシード
        232: 3, // ツキナミ
        233: 4, // スプラバニ
        234: 4, // ホシモグラ
        235: 2, // ヒカリミミズク
        236: 5, // もふツムリ
        237: 3, // ネムネピア
        238: 4, // モフモリス
        239: 3, // ウタタネネコ
        240: 5, // マクマ
        241: 4, // ルナサギ
        242: 3, // ハミングハリネ
        243: 4, // ムーンウッド
        244: 3, // ジェットシェル
        245: 4, // ウネリクラゲ
        246: 3, // スターフィンチ
        247: 3, // ルナリング
        248: 3, // ナイトリンクス
        249: 2, // サンリス
        250: 3, // モフホタル
        251: 4, // サンゴシーホ
        252: 4, // サンドフレア
        253: 3, // タワーガード
        254: 3, // パニエスネイル
        255: 3, // アクアケンタイ
        256: 4, // ギャラクオーブ
        257: 3, // ねこきのこ
        258: 3, // パタパタモミジ
        259: 4, // オチバネズミ
        260: 4, // グルリンモフ
    ]

    private static let displayNames: [Int: String] = [
        1: "スナギンチャク",
        2: "インテリヒトデ",
        3: "トビウミナマコ",
        4: "ヌルウミ",
        5: "フタチエビ",
        6: "モノカゲエビ",
        7: "ナクギョ",
        8: "ソラガメ",
        9: "ササヤキフナムシ",
        10: "無夢クラゲ",
        11: "シオカルガイ",
        12: "ナミカルガイ",
        13: "深海ネガイウミウシ",
        14: "フタボシネガイウミウシ",
        15: "トウシャラガメ",
        16: "ミライガメ",
        17: "シズメンチョウ",
        18: "カクレイカク",
        19: "ネムリイソギン",
        20: "バブルムーブカワウソ",
        21: "コヘビ",
        22: "シラヘビ",
        23: "ナナヘビ",
        24: "ミッシェル",
        25: "キヌガサ",
        26: "ワスレゴイ",
        27: "タマモト",
        28: "バブルマップ",
        29: "ホタルウオ",
        30: "タマコネ",
        31: "カゲマネイカ",
        32: "ホシフグ",
        33: "エコーガニ",
        34: "カイノハナ",
        35: "オルゴヒカリ",
        36: "チョウチンマチョウ",
        37: "ウラリユラリ",
        38: "ユメノカケラ",
        39: "ワラゲクラゲ",
        40: "ヒカリコウラ",
        41: "イソバイソ",
        42: "ユメウナギ",
        43: "ホウセキガイ",
        44: "オモカゲエイ",
        45: "エピピエイ",
        46: "スナスピナー",
        47: "シオリュウ(ベビー)",
        48: "ヒカリツムリ",
        49: "エカキエビ",
        50: "オカキウオ",
        51: "スナヒトデ",
        52: "バニバブル",
        53: "トキノクロノ",
        54: "イロドリフグ",
        55: "シオリュウ",
        56: "ヒソヒソウオ",
        57: "ホタルアメーバ",
        58: "ナナシナシ",
        59: "ナギウナギ",
        60: "チューティー",
        61: "シューティー",
        62: "ナミキオクラゲ",
        63: "パプ",
        64: "エカキガメ",
        65: "アナホリドリ",
        66: "サブンシャ",
        67: "アートフグ",
        68: "カイナラベリス",
        69: "ファクラゲ",
        70: "ユラリフロート",
        71: "ユメシグナ",
        72: "ふうせんタコ",
        73: "ナミシルカニ",
        74: "ナミイトクラゲ",
        75: "ヨルウオ",
        76: "ツキノウオ",
        77: "ユラカゲタコ",
        78: "カゼヒレウオ",
        79: "カゲノオトシゴ",
        80: "トキカゲウオ",
        81: "タマアツメリス",
        82: "スタッシー",
        83: "シャブンサ",
        84: "スナトカゲ",
        85: "オトクラゲ",
        86: "カイキョクフグ",
        87: "ヌルドラゴ",
        88: "ネガイウミウシ",
        89: "ヒョウタンクラゲ",
        90: "サンチャージャ",
        91: "プクドラ",
        92: "アモネコ",
        93: "ソナフィン",
        94: "ツキバブル",
        95: "ネジフィン",
        96: "フカシドリ",
        97: "ケムリザ",
        98: "サンコロ",
        99: "スナグマ",
        100: "ステップ",
        101: "ウィングラゲ",
        102: "ルナジェリー",
        103: "ネムクラゲ",
        104: "ツキクジラ",
        105: "ホシジカ",
        106: "ディープクラゲ",
        107: "ナガレヒツジ",
        108: "アクアホース",
        109: "スタークラゲ",
        110: "クージェル",
        111: "ギャラクダ",
        112: "ホシゴマ",
        113: "ホシギツネ",
        114: "フレアオクト",
        115: "ナギガメ",
        116: "フレアフライ",
        117: "ツキジカ",
        118: "サクラドリ",
        119: "シェルスズメ",
        120: "オトフクモチ",
        121: "ヤミラン",
        122: "ホムニコ",
        123: "ウタドリ",
        124: "ミラリー",
        125: "ナイトフェア",
        126: "ライブラクモ",
        127: "モクレイス",
        128: "ロックニャン",
        129: "リーフリス",
        130: "モノガミネコ",
        131: "ヒカリカブト",
        132: "ヨルフラワ",
        133: "サンドニャ",
        134: "リーフスタグ",
        135: "フワニャ",
        136: "スカーフレット",
        137: "フクプー",
        138: "スナモチ",
        139: "ノビニャン",
        140: "ヒナモリス",
        141: "ギアタートル",
        142: "シーホルダー",
        143: "サギパイル",
        144: "ウイングラット",
        145: "オクタウェーブ",
        146: "スナフクロウ",
        147: "ミズダマリン",
        148: "フワシール",
        149: "アクアワン",
        150: "コモリスズメ",
        151: "ルミファーン",
        152: "アクアフレア",
        153: "バブルテール",
        154: "ドロップシェード",
        155: "アワコン",
        156: "プククロ",
        157: "スプラビット",
        158: "ルナキャット",
        159: "スリーピック",
        160: "アワネコ",
        161: "フレアシップ",
        162: "ロックマイナー",
        163: "ルビージェリー",
        164: "コラルホース",
        165: "フレイムハウンド",
        166: "モスザード",
        167: "ホシネコ",
        168: "アップルモチ",
        169: "カフェモチ",
        170: "ヘルヘム",
        171: "インクスモーク",
        172: "ハリドア",
        173: "ヨムコアラ",
        174: "クロフワ",
        175: "モカフクロウ",
        176: "スペルブックル",
        177: "ルナリンクス",
        178: "トワミミズク",
        179: "ヨルスラグ",
        180: "フミリス",
        181: "フラッシュフィン",
        182: "アクアフラッタ",
        183: "ゴールドモス",
        184: "バブルホース",
        185: "ジェットフィッシュ",
        186: "ラグーンパピー",
        187: "ブロンズインプ",
        188: "コロポン",
        189: "トゲヨーヨー",
        190: "ユメクイバク",
        191: "にゃー",
        192: "みゃー",
        193: "んにゃー",
        194: "うにゃ",
        195: "ナイトクロウ",
        196: "スパイスタグ",
        197: "ボトリート",
        198: "ネムキャット",
        199: "クリームリス",
        200: "テノリラット",
        201: "コーラルラビ",
        202: "ブルーバブ",
        203: "ブラスダイバー",
        204: "プラティッシュ",
        205: "スナスプラウト",
        206: "ルイナイト",
        207: "ウォールクロウ",
        208: "リングザウル",
        209: "クモヒツジ",
        210: "ネムリオモシ",
        211: "スタークトパス",
        212: "スミプチ",
        213: "ルミノグリフ",
        214: "ウェーブゴーレ",
        215: "トレードキャメル",
        216: "ネムカメ",
        217: "アイスベアフロート",
        218: "フロッグガイド",
        219: "ハナクマ",
        220: "ユラユラカゲ",
        221: "スピラホース",
        222: "シュワワーム",
        223: "ニジビースト",
        224: "レインドラ",
        225: "モコリ",
        226: "もちうさ",
        227: "ワタミミ",
        228: "フチョン",
        229: "ユメノモコモコ",
        230: "モココロネ",
        231: "スプラシード",
        232: "ツキナミ",
        233: "スプラバニ",
        234: "ホシモグラ",
        235: "ヒカリミミズク",
        236: "もふツムリ",
        237: "ネムネピア",
        238: "モフモリス",
        239: "ウタタネネコ",
        240: "マクマ",
        241: "ルナサギ",
        242: "ハミングハリネ",
        243: "ムーンウッド",
        244: "ジェットシェル",
        245: "ウネリクラゲ",
        246: "スターフィンチ",
        247: "ルナリング",
        248: "ナイトリンクス",
        249: "サンリス",
        250: "モフホタル",
        251: "サンゴシーホ",
        252: "サンドフレア",
        253: "タワーガード",
        254: "パニエスネイル",
        255: "アクアケンタイ",
        256: "ギャラクオーブ",
        257: "ねこきのこ",
        258: "パタパタモミジ",
        259: "オチバネズミ",
        260: "グルリンモフ"
    ]

    static func displayName(for id: Int) -> String {
        displayNames[id] ?? ""
    }

    static func rarity(for name: String) -> Int {
        let id = id(for: name)
        return info[id] ?? 1
    }

    /// Resolve monster ID from its name
    static func id(for name: String) -> Int {
        if let num = Int(name) {
            return num
        }
        switch name {
        case "nulldrago": return 87
        case "negaiumiushi": return 88
        case "hyoutankurage": return 89
        case "suncharger": return 90
        default: return -1
        }
    }
}
